<!--
JSWM Main element

This is the parent element for all our JSWM components.

Author: Koas (alvaro.calleja@gmail.com)
https://github.com/koas/jswm

-->
<script>
/*jshint esversion: 6 */
/* jshint -W097 */
"use strict";

class JSWmain extends Polymer.Element 
{
    static get is() {return "jswm-main";}

    constructor() 
    {
        super();
        
        this.activeDesktop = null;

        // Default values for config
        this.configData = {apps: [], rootFolderCaption: "Home"};
        
        let configNode = this.querySelector("[type='text/jswm-config']");
        if (configNode)
        {
        	try
        	{
        		let nodeData = JSON.parse(configNode.textContent);

                Object.keys(nodeData).forEach((key) =>
                {
                    this.configData[key] = nodeData[key];
                });
	        }
	        catch(e)
	        {
	        	console.error("Error parsing jswm-main JSON config data.");
	        	console.error(e);
	        }
        }

        // Listen to created desktop event
        this.addEventListener("jswmDesktopCreated", (e) => 
        {
            this.activeDesktop = e.detail.desktop;
        });

        // If user clicks on an icon with id appMenuicon we open the main
        // app menu
        this.addEventListener("jswmIconClicked", (e) =>
        {
            if (e.detail.id == "appMenuIcon" && this.activeDesktop)
                this.activeDesktop.toggleAppMenu(this.configData.apps,
                                                 this.configData.rootFolderCaption);
        });
    }
}

customElements.define(JSWmain.is, JSWmain);
</script>
